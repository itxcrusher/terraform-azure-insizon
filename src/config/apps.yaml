# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#  ğŸŒ Insizon Web App Configuration
#  This YAML defines your App Service deployment and dependencies.
#  Everything here feeds into the `webapp_object` input variable.
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

apps:
  - Name: "insizon-app"
    Env: "dev"

    # â”€â”€ ğŸ” Key Vault Integration â”€â”€
    # Required for fetching secrets and config at runtime
    KeyVaultName: "insizon-dev-keyvault"

    # â”€â”€ ğŸ“ Azure Region and Platform â”€â”€
    Location: "centralus"       # Default is centralus if not specified
    OsType: "Windows"           # Options: Windows or Linux
    Sku: "B1"                   # âš ï¸ Must be B1 or higher if using CustomDomain or AlwaysOn

    # â”€â”€ âš™ï¸ Runtime Configuration â”€â”€
    DotnetVersion: "v8.0"       # Used for Windows apps
    NodeVersion: ""             # Used for Linux apps with Node.js

    # â”€â”€ ğŸ”„ App Service Behavior â”€â”€
    AlwaysOn: true              # âš ï¸ Fails validation if Sku is F1 or D1

    # ğŸ›¡ï¸ TLS & SAS Settings
    MinTLSVersion: "TLS1_2"     # Minimum TLS version for secure connections
    UseSas: true                # Enables SAS token generation for storage accounts
    SasExpiryYears: 10          # SAS token expiry in years (default is 10)

    # â”€â”€ â˜ï¸ Storage Account Config â”€â”€
    StorageConfig:              # Configuration for attached storage accounts
      AccountName: "insizonfilestatic1"  # Primary storage account name
      Tier: "Standard"          # Storage account tier (Standard or Premium)
      Replication: "LRS"        # Replication type (LRS, GRS, etc.)
      PublicAccess: false
      OnlyHttp: true
      PublicNestedItems: false
      MinTLSVersion: "TLS1_2"  # Minimum TLS version for storage access
      UseCDN: true  # Enables CDN for static content delivery

    # â”€â”€ ğŸ§  Monitoring & Integration â”€â”€
    CreateAppInsight: true      # Enables Application Insights
    CreateLogicApp: false       # Optional Logic App workflow binding

    # â”€â”€ ğŸŒ Custom Domain Settings â”€â”€
    CustomDomain:
      URL: "insizon.muhammadhassaanjaved.com"  # Required if using custom hostname
      ZoneName: "muhammadhassaanjaved.com"     # DNS zone name (only if managed_by_azure is true)
      DnsZoneRG: "dns-core-rg"                 # DNS resource group
      UseManagedCert: false                    # Azure-managed SSL cert
      managed_by_azure: false                  # true if DNS is in Azure

    # â”€â”€ ğŸ“ Attached Storage Accounts â”€â”€
    StorageAccount:
      - "insizonfilestatic1"
      - "insizonmediaassets2"

    # â”€â”€ ğŸ§¬ Database Settings â”€â”€
    Database:
      Type: "SQL"                   # Options: SQL or PostgreSQL
      ServerAdminLogin: "adminuser"
      Password: "${DB_PASSWORD}"    # Inject via env.tfvars
      Sku: "GP_S_Gen5_2"
      SizeGB: 5
      MinCapacity: 0.5              # Optional for auto-pause or scaling

    # â”€â”€ âš¡ Redis Cache â”€â”€
    Redis:
      create_service: true
      sku_name: "Standard"          # Options: Basic, Standard, Premium
      capacity: 1                   # Size tier (0â€“6)
      family: "C"                   # C = Basic/Standard, P = Premium
      enable_non_ssl_port: false
